local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local SaveButton = Instance.new("TextButton")
local TeleportButton = Instance.new("TextButton")
local PickButton = Instance.new("TextButton")
local CloseButton = Instance.new("TextButton")
local Title = Instance.new("TextLabel")
local TweenService = game:GetService("TweenService")

-- Настройка GUI
ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.Name = "TeleportTool"
ScreenGui.ResetOnSpawn = false

Frame.Parent = ScreenGui
Frame.BackgroundTransparency = 1 -- Убираем стандартный фон
Frame.BorderSizePixel = 0
Frame.Position = UDim2.new(0.25, 0, 0.3, 0)
Frame.Size = UDim2.new(0, 400, 0, 150)
Frame.Active = true
Frame.Draggable = true
Frame.ClipsDescendants = true

-- Изображение космоса как фон
local spaceBackground = Instance.new("ImageLabel")
spaceBackground.Parent = Frame
spaceBackground.Size = UDim2.new(1, 0, 1, 0)
spaceBackground.Position = UDim2.new(0, 0, 0, 0)
spaceBackground.BackgroundTransparency = 1
spaceBackground.Image = "rbxassetid://2151741365" -- Изображение космоса
spaceBackground.ImageTransparency = 1 -- Начинаем с прозрачности для анимации
spaceBackground.ZIndex = 0

-- Надпись "by artem20929"
local introLabel = Instance.new("TextLabel")
introLabel.Parent = Frame
introLabel.Size = UDim2.new(1, 0, 1, 0)
introLabel.Position = UDim2.new(0, 0, 0, 0)
introLabel.BackgroundTransparency = 1
introLabel.Text = "by artem20929"
introLabel.Font = Enum.Font.SourceSansBold
introLabel.TextColor3 = Color3.fromRGB(50, 47, 196)
introLabel.TextSize = 40
introLabel.TextTransparency = 1
introLabel.ZIndex = 1

-- Элементы интерфейса (скрыты изначально)
Title.Parent = Frame
Title.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Title.BorderSizePixel = 0
Title.Size = UDim2.new(1, 0, 0, 30)
Title.Font = Enum.Font.SourceSans
Title.Text = "Teleport Tool v3"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 18
Title.ZIndex = 2
Title.Visible = false

SaveButton.Parent = Frame
SaveButton.BackgroundColor3 = Color3.fromRGB(70, 120, 70)
SaveButton.BorderSizePixel = 0
SaveButton.Position = UDim2.new(0.05, 0, 0.35, 0)
SaveButton.Size = UDim2.new(0.22, 0, 0, 40)
SaveButton.Font = Enum.Font.SourceSans
SaveButton.Text = "Save Position"
SaveButton.TextColor3 = Color3.fromRGB(255, 255, 255)
SaveButton.TextSize = 16 
SaveButton.ZIndex = 2
SaveButton.Visible = false

PickButton.Parent = Frame
PickButton.BackgroundColor3 = Color3.fromRGB(120, 70, 120)
PickButton.BorderSizePixel = 0
PickButton.Position = UDim2.new(0.29, 0, 0.35, 0)
PickButton.Size = UDim2.new(0.22, 0, 0, 40)
PickButton.Font = Enum.Font.SourceSans
PickButton.Text = "Pick Position"
PickButton.TextColor3 = Color3.fromRGB(255, 255, 255)
PickButton.TextSize = 16
PickButton.ZIndex = 2
PickButton.Visible = false

TeleportButton.Parent = Frame
TeleportButton.BackgroundColor3 = Color3.fromRGB(70, 70, 120)
TeleportButton.BorderSizePixel = 0
TeleportButton.Position = UDim2.new(0.53, 0, 0.35, 0)
TeleportButton.Size = UDim2.new(0.22, 0, 0, 40)
TeleportButton.Font = Enum.Font.SourceSans
TeleportButton.Text = "Teleport"
TeleportButton.TextColor3 = Color3.fromRGB(255, 255, 255)
TeleportButton.TextSize = 16
TeleportButton.ZIndex = 2
TeleportButton.Visible = false

CloseButton.Parent = Frame
CloseButton.BackgroundColor3 = Color3.fromRGB(120, 70, 70)
CloseButton.BorderSizePixel = 0
CloseButton.Position = UDim2.new(0.77, 0, 0.35, 0)
CloseButton.Size = UDim2.new(0.18, 0, 0, 40)
CloseButton.Font = Enum.Font.SourceSans
CloseButton.Text = "Close"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.TextSize = 16
CloseButton.ZIndex = 2
CloseButton.Visible = false

-- Индикатор
local indicatorPart = Instance.new("Part")
indicatorPart.Name = "PositionIndicator"
indicatorPart.Anchored = true
indicatorPart.CanCollide = false
indicatorPart.Transparency = 0.5
indicatorPart.Material = Enum.Material.Neon
indicatorPart.Color = Color3.fromRGB(255, 255, 0)
indicatorPart.Shape = Enum.PartType.Ball
indicatorPart.Size = Vector3.new(0.5, 0.5, 0.5)
indicatorPart.Parent = workspace
indicatorPart.CFrame = CFrame.new(0, 100, 0)

local savedPosition = nil

-- Анимация запуска
local function startupAnimation()
    -- Убедимся, что Frame виден
    Frame.Visible = true

    -- Появление изображения космоса
    local fadeInBackground = TweenInfo.new(0.5, Enum.EasingStyle.Linear, Enum.EasingDirection.Out)
    local backgroundTween = TweenService:Create(spaceBackground, fadeInBackground, {ImageTransparency = 0})
    backgroundTween:Play()
    backgroundTween.Completed:Connect(function()
        -- Появление текста
        local fadeInText = TweenInfo.new(0.5, Enum.EasingStyle.Linear, Enum.EasingDirection.Out)
        local textTween = TweenService:Create(introLabel, fadeInText, {TextTransparency = 0})
        textTween:Play()
        textTween.Completed:Connect(function()
            -- Задержка 1 секунда
            wait(1)
            -- Исчезновение текста (фон остаётся)
            local fadeOut = TweenInfo.new(0.5, Enum.EasingStyle.Linear, Enum.EasingDirection.In)
            local fadeOutTween = TweenService:Create(introLabel, fadeOut, {TextTransparency = 1})
            fadeOutTween:Play()
            fadeOutTween.Completed:Connect(function()
                -- Показываем кнопки и убираем надпись
                introLabel:Destroy()
                Title.Visible = true
                SaveButton.Visible = true
                PickButton.Visible = true
                TeleportButton.Visible = true
                CloseButton.Visible = true
            end)
        end)
    end)
end

startupAnimation()

-- Анимация закрытия
local function closeAnimation(callback)
    local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.In)
    local tween = TweenService:Create(Frame, tweenInfo, {Size = UDim2.new(0, 0, 0, 150)})
    tween:Play()
    tween.Completed:Connect(callback)
end

-- Функции кнопок
SaveButton.MouseButton1Click:Connect(function()
    local character = game.Players.LocalPlayer.Character
    if character and character:FindFirstChild("HumanoidRootPart") then
        savedPosition = character.HumanoidRootPart.CFrame
        indicatorPart.CFrame = savedPosition
    end
end)

PickButton.MouseButton1Click:Connect(function()
    local connection
    connection = game:GetService("UserInputService").InputBegan:Connect(function(input, gameProcessed)
        if input.UserInputType == Enum.UserInputType.MouseButton1 and not gameProcessed then
            local mouse = game.Players.LocalPlayer:GetMouse()
            local ray = Ray.new(mouse.UnitRay.Origin, mouse.UnitRay.Direction * 1000)
            local part, position = workspace:FindPartOnRay(ray, game.Players.LocalPlayer.Character)
            if part then
                savedPosition = CFrame.new(position)
                indicatorPart.CFrame = savedPosition
            end
            connection:Disconnect()
        end
    end)
end)

TeleportButton.MouseButton1Click:Connect(function()
    if savedPosition then
        local character = game.Players.LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") and not character.HumanoidRootPart.Anchored then
            character.HumanoidRootPart.CFrame = savedPosition
        end
    end
end)

CloseButton.MouseButton1Click:Connect(function()
    closeAnimation(function()
        ScreenGui:Destroy()
        indicatorPart:Destroy()
    end)
end)

local UserInputService = game:GetService("UserInputService")
local closeConnection = UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.Escape then
        closeAnimation(function()
            ScreenGui:Destroy()
            indicatorPart:Destroy()
            closeConnection:Disconnect()
        end)
    end
end)

-- Исправленная анимация наведения на кнопки
local function buttonHoverEffect(button)
    local originalColor = button.BackgroundColor3
    button.MouseEnter:Connect(function()
        local tweenInfo = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
        TweenService:Create(button, tweenInfo, {BackgroundColor3 = originalColor:Lerp(Color3.fromRGB(255, 255, 255), 0.2)}):Play()
    end)
    button.MouseLeave:Connect(function()
        local tweenInfo = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
        TweenService:Create(button, tweenInfo, {BackgroundColor3 = originalColor}):Play()
    end)
end

buttonHoverEffect(SaveButton)
buttonHoverEffect(PickButton)
buttonHoverEffect(TeleportButton)
buttonHoverEffect(CloseButton)
